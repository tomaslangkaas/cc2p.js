var cc2p=function(){function w(a){for(var b=Math.floor(a/16777216),d=0,f=[];4>d;d++)f[d]=a>>>8*d&255,f[d+4]=b>>>8*d&255;return f}function t(a){return function(b,d,f,c){f=f||[];var k=[],e=[],h=[],g=p(a,b,0,Array(32)),m=[],l=f.length,n=d.length;x(g,k,e);c||p(a,b,1,d);r(k,e,h,f,l+(16-l%16)%16);r(k,e,h,d,n+(16-n%16)%16);r(k,e,h,w(l).concat(w(n)),16);y(g,e,h,m);if(c){if(m.length!==c.length)c=!1;else{for(k=f=0;f<m.length;f++)k|=m[f]^c[f];c=!(k^0)}b=c?p(a,b,1,d):!1}else b=[d,m];return b}}function u(a,b,d,f){d[f]=a[b]^a[b+1]<<8^a[b+2]<<16^a[b+3]<<24}function l(a,b,d,f,c){a[d]=(a[d]^=a[f]+=a[c]=(a[c]^=a[b]+=a[d])<<16^a[c]>>>16)<<12^a[d]>>>20;a[d]=(a[d]^=a[f]+=a[c]=(a[c]^=a[b]+=a[d])<<8^a[c]>>>24)<<7^a[d]>>>25}function p(a,b,d,f){var c=[1634760805,857760878,2036477234,1797285236],k=f.length,e,h,g,m;for(e=0;4>e;e++)u(a,4*e,c,e+4),u(a,4*(e+4),c,e+8),u(b,4*e,c,(e+1&3)+12);for(b=0;b<k;){c[12]=d++;a=c.slice();for(e=0;10>e;e++)l(a,0,4,8,12),l(a,1,5,9,13),l(a,2,6,10,14),l(a,3,7,11,15),l(a,0,5,10,15),l(a,1,6,11,12),l(a,2,7,8,13),l(a,3,4,9,14);g=b+64;g>k&&(g=k);for(e=0;b<g;b++)(h=b&3)||(m=c[e]+a[e++]|0),f[b]^=m>>>8*h&255}return f}function v(a,b){var d,f=0;for(d=0;17>d;++d)f+=a[d]+b[d],a[d]=f&255,f>>=8}function y(a,b,d,f){var c,k,e=[];for(c=0;17>c;++c)e[c]=b[c];v(b,z);k=-(b[16]>>7);for(c=0;17>c;++c)b[c]^=k&(e[c]^b[c]);for(c=0;16>c;++c)d[c]=a[c+16];d[16]=0;v(b,d);for(c=0;16>c;++c)f[c]=b[c]}function r(a,b,d,f,c){for(var k=0,e,h;k<c;k+=16){for(e=0;17>e;++e)d[e]=0;e=0;for(h=k;16>e&&h<c;e++,h++)d[e]=f[h]||0;d[e]=1;v(b,d);var g,m=b,l=a,n=[];for(g=0;17>g;++g){for(h=e=0;h<=g;++h)e+=m[h]*l[g-h];for(h=g+1;17>h;++h)e+=320*m[h]*l[g+17-h];n[g]=e}for(g=0;17>g;++g)m[g]=n[g];h=m;for(e=g=0;16>e;++e)g+=h[e],h[e]=g&255,g>>=8;g+=h[16];h[16]=g&3;g=5*(g>>2);for(e=0;16>e;++e)g+=h[e],h[e]=g&255,g>>=8;g+=h[16];h[16]=g}}function x(a,b,d){for(var f=0;16>f;f++)b[f]=a[f],d[f]=0;b[3]&=15;b[7]&=15;b[11]&=15;b[15]&=15;b[4]&=252;b[8]&=252;b[12]&=252;b[16]=d[16]=0}var z=[5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,252];t.poly1305=function(a,b){var d=[],f=[],c=[],k=[];x(a,d,f);r(d,f,c,b,b.length);y(a,f,c,k);return k};t.chacha20=p;return t}();
